{% extends "base.html" %}

{% block title %}Erglytics{% endblock %}

{% block head_extra %}
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
  rel="stylesheet"
/>
{% endblock %}

{% block content %}
{% include "partials/masthead.html" %}

<main class="quadrants">
  {% set image = 'images/camera_cool.png' %}
  {% set title = 'Capture Workout' %}
  {% set description = 'Record your workout and get feedback live' %}
  {% set href = url_for('public.template_detail', slug='capture-workout') %}
  {% include "partials/quadrant_card.html" %}

  {% set image = 'images/snapshot_cool.png' %}
  {% set title = 'Snapshot Library' %}
  {% set description = 'View important moments captured during workouts' %}
  {% set href = url_for('public.template_detail', slug='snapshot-library') %}
  {% include "partials/quadrant_card.html" %}

  {% set image = 'images/folder_cool.png' %}
  {% set title = 'Workout Summaries' %}
  {% set description = 'View summaries and analytics from previous workouts' %}
  {% set href = url_for('public.template_detail', slug='workout-summaries') %}
  {% include "partials/quadrant_card.html" %}

  {% set image = 'images/team_cool.png' %}
  {% set title = 'Team View' %}
  {% set description = 'Join a team of like minded athletes and track collective progress' %}
  {% set href = url_for('public.template_detail', slug='team-view') %}
  {% include "partials/quadrant_card.html" %}
</main>
{% endblock %}

{% block scripts %}
<script>
  (function () {
    const parts = window.location.pathname.split("/").filter(Boolean);
    const first = parts[0];
    const stage = first && ["Prod", "Stage", "Dev"].includes(first) ? `/${first}` : "";
    const url = `${stage}/api/count/capture-workout`;
    fetch(url)
      .then(r => r.ok ? r.json() : Promise.reject(new Error(r.statusText || "error")))
      .then(data => {
        const el = document.getElementById("cw-views");
        if (el && data && typeof data.count === "number") {
          el.textContent = data.count;
        }
      })
      .catch(() => {});
  })();
</script>
{% endblock %}

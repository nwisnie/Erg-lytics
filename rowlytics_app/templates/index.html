{% extends "base.html" %}

{% block title %}Erglytics{% endblock %}

{% block head_extra %}
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
  rel="stylesheet"
/>
{% endblock %}

{% block content %}
<header class="masthead">
    <img
      class="logo-mark__image"
      src="{{ 'images/erg_cool.png' | cloudfront_url }}"
      alt="Erglytics mark"
    />
    <span class="logo-mark__text">Erglytics</span>
</header>

<main class="quadrants">
  <section class="quadrant">
    <img
      src="{{ 'images/camera_cool.png' | cloudfront_url }}"
      alt="Capture Workout"
      loading="lazy"
    />
    <div class="quadrant__copy">
      <h2>Capture Workout</h2>
      <p>Record your workout and get feedback live</p>
      <a
        class="btn btn--primary"
        href="{{ url_for('public.template_detail', slug='capture-workout') }}"
      >
        Get Started
      </a>
    </div>
  </section>

  <section class="quadrant">
    <img
      src="{{ 'images/snapshot_cool.png' | cloudfront_url }}"
      alt="Snapshot Library"
      loading="lazy"
    />
    <div class="quadrant__copy">
      <h2>Snapshot Library</h2>
      <p>View important moments captured during workouts</p>
      <a
        class="btn btn--primary"
        href="{{ url_for('public.template_detail', slug='snapshot-library') }}"
      >
        Get Started
      </a>
    </div>
  </section>

  <section class="quadrant">
    <img
      src="{{ 'images/folder_cool.png' | cloudfront_url }}"
      alt="Workout Summaries"
      loading="lazy"
    />
    <div class="quadrant__copy">
      <h2>Workout Summaries</h2>
      <p>View summaries and analytics from previous workouts</p>
      <a
        class="btn btn--primary"
        href="{{ url_for('public.template_detail', slug='workout-summaries') }}"
      >
        Get Started
      </a>
    </div>
  </section>

  <section class="quadrant">
    <img
      src="{{ 'images/team_cool.png' | cloudfront_url }}"
      alt="Team View"
      loading="lazy"
    />
    <div class="quadrant__copy">
      <h2>Team View</h2>
      <p>Join a team of like minded athletes and track collective progress</p>
      <a
        class="btn btn--primary"
        href="{{ url_for('public.template_detail', slug='team-view') }}"
      >
        Get Started
      </a>
    </div>
  </section>
</main>
{% endblock %}

{% block scripts %}
<script>
  (function () {
    const parts = window.location.pathname.split("/").filter(Boolean);
    const first = parts[0];
    const stage = first && ["Prod", "Stage", "Dev"].includes(first) ? `/${first}` : "";
    const url = `${stage}/api/count/capture-workout`;
    fetch(url)
      .then(r => r.ok ? r.json() : Promise.reject(new Error(r.statusText || "error")))
      .then(data => {
        const el = document.getElementById("cw-views");
        if (el && data && typeof data.count === "number") {
          el.textContent = data.count;
        }
      })
      .catch(() => {});
  })();
</script>
{% endblock %}
